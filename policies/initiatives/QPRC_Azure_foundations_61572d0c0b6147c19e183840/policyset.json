{
 "properties": {
  "displayName": "QPRC Azure foundations",
  "policyType": "Custom",
  "description": "Policies to enable basic Azure foundations",
  "metadata": {
   "category": "Foundations",
   "version": "1.0",
   "parameterScopes": {
    "listOfAllowedLocations": "/subscriptions/23bf9984-442a-4564-a599-c883a24e3e77"
   },
   "createdBy": "69bd8a54-2e6a-4c71-8aaa-02af4381fafa",
   "createdOn": "2021-02-02T05:43:02.3903458Z",
   "updatedBy": "69bd8a54-2e6a-4c71-8aaa-02af4381fafa",
   "updatedOn": "2021-02-03T02:32:20.5963137Z"
  },
  "parameters": {
   "Allowed_Locations": {
    "type": "Array",
    "metadata": {
     "displayName": "Locations",
     "description": null
    },
    "allowedValues": [
     "australiaeast",
     "australiasouth"
    ],
    "defaultValue": [
     "australiaeast",
     "australiasouth"
    ]
   }
  },
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Allowed locations_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
    "parameters": {
     "listOfAllowedLocations": {
      "value": "[parameters('Allowed_Locations')]"
     }
    },
    "groupNames": [
     "Allowed_Locations"
    ]
   },
   {
    "policyDefinitionReferenceId": "Require a tag on resource groups_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025",
    "parameters": {
     "tagName": {
      "value": "Environment"
     }
    },
    "groupNames": [
     "Require_Tags"
    ]
   },
   {
    "policyDefinitionReferenceId": "Require a tag on resource groups_2",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025",
    "parameters": {
     "tagName": {
      "value": "Owner"
     }
    },
    "groupNames": [
     "Require_Tags"
    ]
   },
   {
    "policyDefinitionReferenceId": "Require a tag on resource groups_3",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025",
    "parameters": {
     "tagName": {
      "value": "Function"
     }
    },
    "groupNames": [
     "Require_Tags"
    ]
   },
   {
    "policyDefinitionReferenceId": "Require a tag on resource groups_4",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025",
    "parameters": {
     "tagName": {
      "value": "CreatedDate"
     }
    },
    "groupNames": [
     "Require_Tags"
    ]
   },
   {
    "policyDefinitionReferenceId": "Require a tag on resource groups_5",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025",
    "parameters": {
     "tagName": {
      "value": "CreatedBy"
     }
    },
    "groupNames": [
     "Require_Tags"
    ]
   },
   {
    "policyDefinitionReferenceId": "System updates should be installed on your machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
    "parameters": {},
    "groupNames": [
     "Virtual_machines"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Storage should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/308fbb08-4ab8-4e67-9b29-592e93fb94fa",
    "parameters": {},
    "groupNames": [
     "Azure_Defender"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for servers should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d",
    "parameters": {},
    "groupNames": [
     "Azure_Defender"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for SQL servers on machines should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b",
    "parameters": {},
    "groupNames": [
     "Azure_Defender"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Key Vault should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
    "parameters": {},
    "groupNames": [
     "Azure_Defender"
    ]
   }
  ],
  "policyDefinitionGroups": [
   {
    "name": "Require_Tags",
    "category": "ResourceGroups"
   },
   {
    "name": "Allowed_Locations",
    "category": "Locations"
   },
   {
    "name": "Virtual_machines",
    "category": "Updates"
   },
   {
    "name": "Azure_Defender",
    "category": "Defender"
   }
  ]
 },
 "id": "/subscriptions/23bf9984-442a-4564-a599-c883a24e3e77/providers/Microsoft.Authorization/policySetDefinitions/61572d0c0b6147c19e183840",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "61572d0c0b6147c19e183840"
}